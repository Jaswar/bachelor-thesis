Looking for a split for p=0.2
Found split for p=0.2 [40 videos]
Moving sampled images to a separate folder
Finished sampling
/home/jwarchocki/.conda/envs/action-former/lib/python3.10/site-packages/torch/utils/data/dataloader.py:554: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
{'dataset': {'crop_ratio': [0.9, 1.0],
             'default_fps': None,
             'downsample_rate': 1,
             'feat_folder': './data/thumos/i3d_features',
             'feat_stride': 4,
             'file_ext': '.npy',
             'file_prefix': None,
             'force_upsampling': False,
             'input_dim': 2048,
             'json_file': './data/thumos/annotations/thumos14.json',
             'max_seq_len': 2304,
             'num_classes': 20,
             'num_frames': 16,
             'trunc_thresh': 0.5},
 'dataset_name': 'thumos',
 'devices': ['cuda:0'],
 'init_rand_seed': 1234567891,
 'loader': {'batch_size': 2, 'num_workers': 4},
 'model': {'backbone_arch': (2, 2, 5),
           'backbone_type': 'convTransformer',
           'embd_dim': 512,
           'embd_kernel_size': 3,
           'embd_with_ln': True,
           'fpn_dim': 512,
           'fpn_start_level': 0,
           'fpn_type': 'identity',
           'fpn_with_ln': True,
           'head_dim': 512,
           'head_kernel_size': 3,
           'head_num_layers': 3,
           'head_with_ln': True,
           'input_dim': 2048,
           'max_buffer_len_factor': 6.0,
           'max_seq_len': 2304,
           'n_head': 4,
           'n_mha_win_size': 19,
           'num_classes': 20,
           'regression_range': [(0, 4),
                                (4, 8),
                                (8, 16),
                                (16, 32),
                                (32, 64),
                                (64, 10000)],
           'scale_factor': 2,
           'test_cfg': {'duration_thresh': 0.05,
                        'ext_score_file': None,
                        'iou_threshold': 0.1,
                        'max_seg_num': 200,
                        'min_score': 0.001,
                        'multiclass_nms': True,
                        'nms_method': 'soft',
                        'nms_sigma': 0.5,
                        'pre_nms_thresh': 0.001,
                        'pre_nms_topk': 2000,
                        'voting_thresh': 0.7},
           'train_cfg': {'center_sample': 'radius',
                         'center_sample_radius': 1.5,
                         'clip_grad_l2norm': 1.0,
                         'cls_prior_prob': 0.01,
                         'dropout': 0.0,
                         'droppath': 0.1,
                         'head_empty_cls': [],
                         'init_loss_norm': 100,
                         'label_smoothing': 0.0,
                         'loss_weight': 1.0},
           'use_abs_pe': False,
           'use_rel_pe': False},
 'model_name': 'LocPointTransformer',
 'opt': {'epochs': 30,
         'learning_rate': 0.0001,
         'momentum': 0.9,
         'schedule_gamma': 0.1,
         'schedule_steps': [],
         'schedule_type': 'cosine',
         'type': 'AdamW',
         'warmup': True,
         'warmup_epochs': 5,
         'weight_decay': 0.05},
 'output_folder': './ckpt/',
 'test_cfg': {'duration_thresh': 0.05,
              'ext_score_file': None,
              'iou_threshold': 0.1,
              'max_seg_num': 200,
              'min_score': 0.001,
              'multiclass_nms': True,
              'nms_method': 'soft',
              'nms_sigma': 0.5,
              'pre_nms_thresh': 0.001,
              'pre_nms_topk': 2000,
              'voting_thresh': 0.7},
 'train_cfg': {'center_sample': 'radius',
               'center_sample_radius': 1.5,
               'clip_grad_l2norm': 1.0,
               'cls_prior_prob': 0.01,
               'dropout': 0.0,
               'droppath': 0.1,
               'head_empty_cls': [],
               'init_loss_norm': 100,
               'label_smoothing': 0.0,
               'loss_weight': 1.0},
 'train_split': ['validation'],
 'val_split': ['test']}
Using model EMA ...

Start training model LocPointTransformer ...

[Train]: Epoch 0 started
Epoch: [000][00010/00020]	Time 4.75 (4.75)	Loss 2.15 (2.15)
		cls_loss 1.36 (1.36)	reg_loss 0.79 (0.79)
[Train]: Epoch 0 finished with lr=0.00002020


[Train]: Epoch 1 started
Epoch: [001][00010/00020]	Time 0.28 (0.28)	Loss 1.89 (1.89)
		cls_loss 1.56 (1.56)	reg_loss 0.33 (0.33)
[Train]: Epoch 1 finished with lr=0.00004040


[Train]: Epoch 2 started
Epoch: [002][00010/00020]	Time 0.28 (0.28)	Loss 0.26 (0.26)
		cls_loss 0.18 (0.18)	reg_loss 0.08 (0.08)
[Train]: Epoch 2 finished with lr=0.00006061


[Train]: Epoch 3 started
Epoch: [003][00010/00020]	Time 0.28 (0.28)	Loss 2.87 (2.87)
		cls_loss 1.92 (1.92)	reg_loss 0.95 (0.95)
[Train]: Epoch 3 finished with lr=0.00008081


[Train]: Epoch 4 started
Epoch: [004][00010/00020]	Time 0.27 (0.27)	Loss 1.30 (1.30)
		cls_loss 0.93 (0.93)	reg_loss 0.38 (0.38)
[Train]: Epoch 4 finished with lr=0.00010000


[Train]: Epoch 5 started
Epoch: [005][00010/00020]	Time 0.28 (0.28)	Loss 0.70 (0.70)
		cls_loss 0.52 (0.52)	reg_loss 0.19 (0.19)
[Train]: Epoch 5 finished with lr=0.00009973


[Train]: Epoch 6 started
Epoch: [006][00010/00020]	Time 0.53 (0.53)	Loss 1.53 (1.53)
		cls_loss 0.91 (0.91)	reg_loss 0.63 (0.63)
[Train]: Epoch 6 finished with lr=0.00009891


[Train]: Epoch 7 started
Epoch: [007][00010/00020]	Time 0.28 (0.28)	Loss 0.24 (0.24)
		cls_loss 0.18 (0.18)	reg_loss 0.06 (0.06)
[Train]: Epoch 7 finished with lr=0.00009755


[Train]: Epoch 8 started
Epoch: [008][00010/00020]	Time 0.29 (0.29)	Loss 0.94 (0.94)
		cls_loss 0.64 (0.64)	reg_loss 0.30 (0.30)
[Train]: Epoch 8 finished with lr=0.00009568


[Train]: Epoch 9 started
Epoch: [009][00010/00020]	Time 0.29 (0.29)	Loss 0.42 (0.42)
		cls_loss 0.29 (0.29)	reg_loss 0.13 (0.13)
[Train]: Epoch 9 finished with lr=0.00009330


[Train]: Epoch 10 started
Epoch: [010][00010/00020]	Time 0.28 (0.28)	Loss 0.30 (0.30)
		cls_loss 0.21 (0.21)	reg_loss 0.09 (0.09)
[Train]: Epoch 10 finished with lr=0.00009045


[Train]: Epoch 11 started
Epoch: [011][00010/00020]	Time 0.28 (0.28)	Loss 1.40 (1.40)
		cls_loss 0.99 (0.99)	reg_loss 0.41 (0.41)
[Train]: Epoch 11 finished with lr=0.00008716


[Train]: Epoch 12 started
Epoch: [012][00010/00020]	Time 0.27 (0.27)	Loss 0.21 (0.21)
		cls_loss 0.13 (0.13)	reg_loss 0.09 (0.09)
[Train]: Epoch 12 finished with lr=0.00008346


[Train]: Epoch 13 started
Epoch: [013][00010/00020]	Time 0.27 (0.27)	Loss 0.11 (0.11)
		cls_loss 0.07 (0.07)	reg_loss 0.04 (0.04)
[Train]: Epoch 13 finished with lr=0.00007939


[Train]: Epoch 14 started
Epoch: [014][00010/00020]	Time 0.27 (0.27)	Loss 0.40 (0.40)
		cls_loss 0.24 (0.24)	reg_loss 0.16 (0.16)
[Train]: Epoch 14 finished with lr=0.00007500


[Train]: Epoch 15 started
Epoch: [015][00010/00020]	Time 0.29 (0.29)	Loss 0.91 (0.91)
		cls_loss 0.45 (0.45)	reg_loss 0.47 (0.47)
[Train]: Epoch 15 finished with lr=0.00007034


[Train]: Epoch 16 started
Epoch: [016][00010/00020]	Time 0.27 (0.27)	Loss 0.82 (0.82)
		cls_loss 0.59 (0.59)	reg_loss 0.23 (0.23)
[Train]: Epoch 16 finished with lr=0.00006545


[Train]: Epoch 17 started
Epoch: [017][00010/00020]	Time 0.27 (0.27)	Loss 0.61 (0.61)
		cls_loss 0.33 (0.33)	reg_loss 0.28 (0.28)
[Train]: Epoch 17 finished with lr=0.00006040


[Train]: Epoch 18 started
Epoch: [018][00010/00020]	Time 0.27 (0.27)	Loss 0.40 (0.40)
		cls_loss 0.26 (0.26)	reg_loss 0.14 (0.14)
[Train]: Epoch 18 finished with lr=0.00005523


[Train]: Epoch 19 started
Epoch: [019][00010/00020]	Time 0.27 (0.27)	Loss 0.50 (0.50)
		cls_loss 0.35 (0.35)	reg_loss 0.15 (0.15)
[Train]: Epoch 19 finished with lr=0.00005001


[Train]: Epoch 20 started
Epoch: [020][00010/00020]	Time 0.29 (0.29)	Loss 0.16 (0.16)
		cls_loss 0.09 (0.09)	reg_loss 0.08 (0.08)
[Train]: Epoch 20 finished with lr=0.00004478


[Train]: Epoch 21 started
Epoch: [021][00010/00020]	Time 0.27 (0.27)	Loss 0.48 (0.48)
		cls_loss 0.27 (0.27)	reg_loss 0.21 (0.21)
[Train]: Epoch 21 finished with lr=0.00003961


[Train]: Epoch 22 started
Epoch: [022][00010/00020]	Time 0.28 (0.28)	Loss 1.16 (1.16)
		cls_loss 0.66 (0.66)	reg_loss 0.49 (0.49)
[Train]: Epoch 22 finished with lr=0.00003456


[Train]: Epoch 23 started
Epoch: [023][00010/00020]	Time 0.29 (0.29)	Loss 0.22 (0.22)
		cls_loss 0.13 (0.13)	reg_loss 0.09 (0.09)
[Train]: Epoch 23 finished with lr=0.00002967


[Train]: Epoch 24 started
Epoch: [024][00010/00020]	Time 0.27 (0.27)	Loss 0.56 (0.56)
		cls_loss 0.29 (0.29)	reg_loss 0.27 (0.27)
[Train]: Epoch 24 finished with lr=0.00002501


[Train]: Epoch 25 started
Epoch: [025][00010/00020]	Time 0.28 (0.28)	Loss 0.55 (0.55)
		cls_loss 0.30 (0.30)	reg_loss 0.25 (0.25)
[Train]: Epoch 25 finished with lr=0.00002062


[Train]: Epoch 26 started
Epoch: [026][00010/00020]	Time 0.29 (0.29)	Loss 0.42 (0.42)
		cls_loss 0.22 (0.22)	reg_loss 0.20 (0.20)
[Train]: Epoch 26 finished with lr=0.00001655


[Train]: Epoch 27 started
Epoch: [027][00010/00020]	Time 0.29 (0.29)	Loss 0.21 (0.21)
		cls_loss 0.13 (0.13)	reg_loss 0.08 (0.08)
[Train]: Epoch 27 finished with lr=0.00001285


[Train]: Epoch 28 started
Epoch: [028][00010/00020]	Time 0.28 (0.28)	Loss 0.71 (0.71)
		cls_loss 0.37 (0.37)	reg_loss 0.34 (0.34)
[Train]: Epoch 28 finished with lr=0.00000956


[Train]: Epoch 29 started
Epoch: [029][00010/00020]	Time 0.29 (0.29)	Loss 0.07 (0.07)
		cls_loss 0.04 (0.04)	reg_loss 0.03 (0.03)
[Train]: Epoch 29 finished with lr=0.00000671


[Train]: Epoch 30 started
Epoch: [030][00010/00020]	Time 0.28 (0.28)	Loss 0.15 (0.15)
		cls_loss 0.08 (0.08)	reg_loss 0.07 (0.07)
[Train]: Epoch 30 finished with lr=0.00000433


[Train]: Epoch 31 started
Epoch: [031][00010/00020]	Time 0.28 (0.28)	Loss 0.10 (0.10)
		cls_loss 0.06 (0.06)	reg_loss 0.04 (0.04)
[Train]: Epoch 31 finished with lr=0.00000246


[Train]: Epoch 32 started
Epoch: [032][00010/00020]	Time 0.28 (0.28)	Loss 0.13 (0.13)
		cls_loss 0.07 (0.07)	reg_loss 0.05 (0.05)
[Train]: Epoch 32 finished with lr=0.00000110


[Train]: Epoch 33 started
Epoch: [033][00010/00020]	Time 0.27 (0.27)	Loss 0.10 (0.10)
		cls_loss 0.06 (0.06)	reg_loss 0.04 (0.04)
[Train]: Epoch 33 finished with lr=0.00000028


[Train]: Epoch 34 started
Epoch: [034][00010/00020]	Time 0.28 (0.28)	Loss 0.28 (0.28)
		cls_loss 0.19 (0.19)	reg_loss 0.09 (0.09)
[Train]: Epoch 34 finished with lr=0.00000001

Time taken to train: 232.70643877983093
All done!
/home/jwarchocki/.conda/envs/action-former/lib/python3.10/site-packages/torch/utils/data/dataloader.py:554: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
/home/jwarchocki/.conda/envs/action-former/lib/python3.10/site-packages/torch/utils/data/dataloader.py:554: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
{'dataset': {'crop_ratio': [0.9, 1.0],
             'default_fps': None,
             'downsample_rate': 1,
             'feat_folder': './data/thumos/i3d_features',
             'feat_stride': 4,
             'file_ext': '.npy',
             'file_prefix': None,
             'force_upsampling': False,
             'input_dim': 2048,
             'json_file': './data/thumos/annotations/thumos14.json',
             'max_seq_len': 2304,
             'num_classes': 20,
             'num_frames': 16,
             'trunc_thresh': 0.5},
 'dataset_name': 'thumos',
 'devices': ['cuda:0'],
 'init_rand_seed': 1234567891,
 'loader': {'batch_size': 2, 'num_workers': 4},
 'model': {'backbone_arch': (2, 2, 5),
           'backbone_type': 'convTransformer',
           'embd_dim': 512,
           'embd_kernel_size': 3,
           'embd_with_ln': True,
           'fpn_dim': 512,
           'fpn_start_level': 0,
           'fpn_type': 'identity',
           'fpn_with_ln': True,
           'head_dim': 512,
           'head_kernel_size': 3,
           'head_num_layers': 3,
           'head_with_ln': True,
           'input_dim': 2048,
           'max_buffer_len_factor': 6.0,
           'max_seq_len': 2304,
           'n_head': 4,
           'n_mha_win_size': 19,
           'num_classes': 20,
           'regression_range': [(0, 4),
                                (4, 8),
                                (8, 16),
                                (16, 32),
                                (32, 64),
                                (64, 10000)],
           'scale_factor': 2,
           'test_cfg': {'duration_thresh': 0.05,
                        'ext_score_file': None,
                        'iou_threshold': 0.1,
                        'max_seg_num': 200,
                        'min_score': 0.001,
                        'multiclass_nms': True,
                        'nms_method': 'soft',
                        'nms_sigma': 0.5,
                        'pre_nms_thresh': 0.001,
                        'pre_nms_topk': 2000,
                        'voting_thresh': 0.7},
           'train_cfg': {'center_sample': 'radius',
                         'center_sample_radius': 1.5,
                         'clip_grad_l2norm': 1.0,
                         'cls_prior_prob': 0.01,
                         'dropout': 0.0,
                         'droppath': 0.1,
                         'head_empty_cls': [],
                         'init_loss_norm': 100,
                         'label_smoothing': 0.0,
                         'loss_weight': 1.0},
           'use_abs_pe': False,
           'use_rel_pe': False},
 'model_name': 'LocPointTransformer',
 'opt': {'epochs': 30,
         'learning_rate': 0.0001,
         'momentum': 0.9,
         'schedule_gamma': 0.1,
         'schedule_steps': [],
         'schedule_type': 'cosine',
         'type': 'AdamW',
         'warmup': True,
         'warmup_epochs': 5,
         'weight_decay': 0.05},
 'output_folder': './ckpt/',
 'test_cfg': {'duration_thresh': 0.05,
              'ext_score_file': None,
              'iou_threshold': 0.1,
              'max_seg_num': 200,
              'min_score': 0.001,
              'multiclass_nms': True,
              'nms_method': 'soft',
              'nms_sigma': 0.5,
              'pre_nms_thresh': 0.001,
              'pre_nms_topk': 2000,
              'voting_thresh': 0.7},
 'train_cfg': {'center_sample': 'radius',
               'center_sample_radius': 1.5,
               'clip_grad_l2norm': 1.0,
               'cls_prior_prob': 0.01,
               'dropout': 0.0,
               'droppath': 0.1,
               'head_empty_cls': [],
               'init_loss_norm': 100,
               'label_smoothing': 0.0,
               'loss_weight': 1.0},
 'train_split': ['validation'],
 'val_split': ['test']}
=> loading checkpoint './ckpt/thumos_i3d_reproduce/epoch_035.pth.tar'
Loading from EMA model ...

Start testing model LocPointTransformer ...
Test: [00010/00212]	Time 0.57 (0.57)
Test: [00020/00212]	Time 0.09 (0.33)
Test: [00030/00212]	Time 0.10 (0.25)
Test: [00040/00212]	Time 0.11 (0.22)
Test: [00050/00212]	Time 0.10 (0.19)
Test: [00060/00212]	Time 0.09 (0.18)
Test: [00070/00212]	Time 0.09 (0.16)
Test: [00080/00212]	Time 0.10 (0.16)
Test: [00090/00212]	Time 0.09 (0.15)
Test: [00100/00212]	Time 0.11 (0.14)
Test: [00110/00212]	Time 0.11 (0.14)
Test: [00120/00212]	Time 0.10 (0.14)
Test: [00130/00212]	Time 0.11 (0.13)
Test: [00140/00212]	Time 0.10 (0.13)
Test: [00150/00212]	Time 0.09 (0.13)
Test: [00160/00212]	Time 0.15 (0.13)
Test: [00170/00212]	Time 0.13 (0.13)
Test: [00180/00212]	Time 0.11 (0.13)
Test: [00190/00212]	Time 0.11 (0.13)
Test: [00200/00212]	Time 0.10 (0.13)
Test: [00210/00212]	Time 0.08 (0.12)
[RESULTS] Action detection results on thumos14.

|tIoU = 0.30: mAP = 43.13 (%) Recall@1x = 57.79 (%) Recall@5x = 80.58 (%) 
|tIoU = 0.40: mAP = 35.20 (%) Recall@1x = 48.87 (%) Recall@5x = 71.56 (%) 
|tIoU = 0.50: mAP = 26.70 (%) Recall@1x = 40.61 (%) Recall@5x = 60.45 (%) 
|tIoU = 0.60: mAP = 16.27 (%) Recall@1x = 30.02 (%) Recall@5x = 44.32 (%) 
|tIoU = 0.70: mAP = 7.73 (%) Recall@1x = 19.34 (%) Recall@5x = 27.37 (%) 
Average mAP: 25.80 (%)
All done! Total time: 141.17 sec
Looking for a split for p=0.2
Found split for p=0.2 [40 videos]
Moving sampled images to a separate folder
Finished sampling
/home/jwarchocki/.conda/envs/action-former/lib/python3.10/site-packages/torch/utils/data/dataloader.py:554: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
{'dataset': {'crop_ratio': [0.9, 1.0],
             'default_fps': None,
             'downsample_rate': 1,
             'feat_folder': './data/thumos/i3d_features',
             'feat_stride': 4,
             'file_ext': '.npy',
             'file_prefix': None,
             'force_upsampling': False,
             'input_dim': 2048,
             'json_file': './data/thumos/annotations/thumos14.json',
             'max_seq_len': 2304,
             'num_classes': 20,
             'num_frames': 16,
             'trunc_thresh': 0.5},
 'dataset_name': 'thumos',
 'devices': ['cuda:0'],
 'init_rand_seed': 1234567891,
 'loader': {'batch_size': 2, 'num_workers': 4},
 'model': {'backbone_arch': (2, 2, 5),
           'backbone_type': 'convTransformer',
           'embd_dim': 512,
           'embd_kernel_size': 3,
           'embd_with_ln': True,
           'fpn_dim': 512,
           'fpn_start_level': 0,
           'fpn_type': 'identity',
           'fpn_with_ln': True,
           'head_dim': 512,
           'head_kernel_size': 3,
           'head_num_layers': 3,
           'head_with_ln': True,
           'input_dim': 2048,
           'max_buffer_len_factor': 6.0,
           'max_seq_len': 2304,
           'n_head': 4,
           'n_mha_win_size': 19,
           'num_classes': 20,
           'regression_range': [(0, 4),
                                (4, 8),
                                (8, 16),
                                (16, 32),
                                (32, 64),
                                (64, 10000)],
           'scale_factor': 2,
           'test_cfg': {'duration_thresh': 0.05,
                        'ext_score_file': None,
                        'iou_threshold': 0.1,
                        'max_seg_num': 200,
                        'min_score': 0.001,
                        'multiclass_nms': True,
                        'nms_method': 'soft',
                        'nms_sigma': 0.5,
                        'pre_nms_thresh': 0.001,
                        'pre_nms_topk': 2000,
                        'voting_thresh': 0.7},
           'train_cfg': {'center_sample': 'radius',
                         'center_sample_radius': 1.5,
                         'clip_grad_l2norm': 1.0,
                         'cls_prior_prob': 0.01,
                         'dropout': 0.0,
                         'droppath': 0.1,
                         'head_empty_cls': [],
                         'init_loss_norm': 100,
                         'label_smoothing': 0.0,
                         'loss_weight': 1.0},
           'use_abs_pe': False,
           'use_rel_pe': False},
 'model_name': 'LocPointTransformer',
 'opt': {'epochs': 30,
         'learning_rate': 0.0001,
         'momentum': 0.9,
         'schedule_gamma': 0.1,
         'schedule_steps': [],
         'schedule_type': 'cosine',
         'type': 'AdamW',
         'warmup': True,
         'warmup_epochs': 5,
         'weight_decay': 0.05},
 'output_folder': './ckpt/',
 'test_cfg': {'duration_thresh': 0.05,
              'ext_score_file': None,
              'iou_threshold': 0.1,
              'max_seg_num': 200,
              'min_score': 0.001,
              'multiclass_nms': True,
              'nms_method': 'soft',
              'nms_sigma': 0.5,
              'pre_nms_thresh': 0.001,
              'pre_nms_topk': 2000,
              'voting_thresh': 0.7},
 'train_cfg': {'center_sample': 'radius',
               'center_sample_radius': 1.5,
               'clip_grad_l2norm': 1.0,
               'cls_prior_prob': 0.01,
               'dropout': 0.0,
               'droppath': 0.1,
               'head_empty_cls': [],
               'init_loss_norm': 100,
               'label_smoothing': 0.0,
               'loss_weight': 1.0},
 'train_split': ['validation'],
 'val_split': ['test']}
Using model EMA ...

Start training model LocPointTransformer ...

[Train]: Epoch 0 started
Epoch: [000][00010/00020]	Time 0.98 (0.98)	Loss 1.24 (1.24)
		cls_loss 0.82 (0.82)	reg_loss 0.42 (0.42)
[Train]: Epoch 0 finished with lr=0.00002020


[Train]: Epoch 1 started
Epoch: [001][00010/00020]	Time 0.27 (0.27)	Loss 1.58 (1.58)
		cls_loss 1.16 (1.16)	reg_loss 0.42 (0.42)
[Train]: Epoch 1 finished with lr=0.00004040


[Train]: Epoch 2 started
Epoch: [002][00010/00020]	Time 0.27 (0.27)	Loss 0.67 (0.67)
		cls_loss 0.46 (0.46)	reg_loss 0.21 (0.21)
[Train]: Epoch 2 finished with lr=0.00006061


[Train]: Epoch 3 started
Epoch: [003][00010/00020]	Time 0.27 (0.27)	Loss 0.75 (0.75)
		cls_loss 0.55 (0.55)	reg_loss 0.20 (0.20)
[Train]: Epoch 3 finished with lr=0.00008081


[Train]: Epoch 4 started
Epoch: [004][00010/00020]	Time 0.27 (0.27)	Loss 1.14 (1.14)
		cls_loss 0.77 (0.77)	reg_loss 0.37 (0.37)
[Train]: Epoch 4 finished with lr=0.00010000


[Train]: Epoch 5 started
Epoch: [005][00010/00020]	Time 0.28 (0.28)	Loss 0.60 (0.60)
		cls_loss 0.42 (0.42)	reg_loss 0.18 (0.18)
[Train]: Epoch 5 finished with lr=0.00009973


[Train]: Epoch 6 started
Epoch: [006][00010/00020]	Time 0.27 (0.27)	Loss 0.56 (0.56)
		cls_loss 0.38 (0.38)	reg_loss 0.18 (0.18)
[Train]: Epoch 6 finished with lr=0.00009891


[Train]: Epoch 7 started
Epoch: [007][00010/00020]	Time 0.28 (0.28)	Loss 0.88 (0.88)
		cls_loss 0.54 (0.54)	reg_loss 0.34 (0.34)
[Train]: Epoch 7 finished with lr=0.00009755


[Train]: Epoch 8 started
Epoch: [008][00010/00020]	Time 0.29 (0.29)	Loss 0.44 (0.44)
		cls_loss 0.30 (0.30)	reg_loss 0.14 (0.14)
[Train]: Epoch 8 finished with lr=0.00009568


[Train]: Epoch 9 started
Epoch: [009][00010/00020]	Time 0.27 (0.27)	Loss 1.10 (1.10)
		cls_loss 0.70 (0.70)	reg_loss 0.40 (0.40)
[Train]: Epoch 9 finished with lr=0.00009330


[Train]: Epoch 10 started
Epoch: [010][00010/00020]	Time 0.27 (0.27)	Loss 0.44 (0.44)
		cls_loss 0.30 (0.30)	reg_loss 0.13 (0.13)
[Train]: Epoch 10 finished with lr=0.00009045


[Train]: Epoch 11 started
Epoch: [011][00010/00020]	Time 0.28 (0.28)	Loss 0.28 (0.28)
		cls_loss 0.19 (0.19)	reg_loss 0.10 (0.10)
[Train]: Epoch 11 finished with lr=0.00008716


[Train]: Epoch 12 started
Epoch: [012][00010/00020]	Time 0.28 (0.28)	Loss 1.79 (1.79)
		cls_loss 1.26 (1.26)	reg_loss 0.53 (0.53)
[Train]: Epoch 12 finished with lr=0.00008346


[Train]: Epoch 13 started
Epoch: [013][00010/00020]	Time 0.27 (0.27)	Loss 0.52 (0.52)
		cls_loss 0.32 (0.32)	reg_loss 0.20 (0.20)
[Train]: Epoch 13 finished with lr=0.00007939


[Train]: Epoch 14 started
Epoch: [014][00010/00020]	Time 0.28 (0.28)	Loss 0.42 (0.42)
		cls_loss 0.26 (0.26)	reg_loss 0.16 (0.16)
[Train]: Epoch 14 finished with lr=0.00007500


[Train]: Epoch 15 started
Epoch: [015][00010/00020]	Time 0.28 (0.28)	Loss 0.21 (0.21)
		cls_loss 0.13 (0.13)	reg_loss 0.08 (0.08)
[Train]: Epoch 15 finished with lr=0.00007034


[Train]: Epoch 16 started
Epoch: [016][00010/00020]	Time 0.27 (0.27)	Loss 1.04 (1.04)
		cls_loss 0.69 (0.69)	reg_loss 0.36 (0.36)
[Train]: Epoch 16 finished with lr=0.00006545


[Train]: Epoch 17 started
Epoch: [017][00010/00020]	Time 0.27 (0.27)	Loss 0.53 (0.53)
		cls_loss 0.33 (0.33)	reg_loss 0.20 (0.20)
[Train]: Epoch 17 finished with lr=0.00006040


[Train]: Epoch 18 started
Epoch: [018][00010/00020]	Time 0.37 (0.37)	Loss 1.64 (1.64)
		cls_loss 1.05 (1.05)	reg_loss 0.60 (0.60)
[Train]: Epoch 18 finished with lr=0.00005523


[Train]: Epoch 19 started
Epoch: [019][00010/00020]	Time 0.27 (0.27)	Loss 0.26 (0.26)
		cls_loss 0.16 (0.16)	reg_loss 0.11 (0.11)
[Train]: Epoch 19 finished with lr=0.00005001


[Train]: Epoch 20 started
Epoch: [020][00010/00020]	Time 0.30 (0.30)	Loss 1.00 (1.00)
		cls_loss 0.52 (0.52)	reg_loss 0.48 (0.48)
[Train]: Epoch 20 finished with lr=0.00004478


[Train]: Epoch 21 started
Epoch: [021][00010/00020]	Time 0.27 (0.27)	Loss 0.80 (0.80)
		cls_loss 0.49 (0.49)	reg_loss 0.31 (0.31)
[Train]: Epoch 21 finished with lr=0.00003961


[Train]: Epoch 22 started
Epoch: [022][00010/00020]	Time 0.28 (0.28)	Loss 0.21 (0.21)
		cls_loss 0.12 (0.12)	reg_loss 0.09 (0.09)
[Train]: Epoch 22 finished with lr=0.00003456


[Train]: Epoch 23 started
Epoch: [023][00010/00020]	Time 0.28 (0.28)	Loss 0.33 (0.33)
		cls_loss 0.18 (0.18)	reg_loss 0.15 (0.15)
[Train]: Epoch 23 finished with lr=0.00002967


[Train]: Epoch 24 started
Epoch: [024][00010/00020]	Time 0.28 (0.28)	Loss 0.03 (0.03)
		cls_loss 0.01 (0.01)	reg_loss 0.01 (0.01)
[Train]: Epoch 24 finished with lr=0.00002501


[Train]: Epoch 25 started
Epoch: [025][00010/00020]	Time 0.28 (0.28)	Loss 0.47 (0.47)
		cls_loss 0.27 (0.27)	reg_loss 0.20 (0.20)
[Train]: Epoch 25 finished with lr=0.00002062


[Train]: Epoch 26 started
Epoch: [026][00010/00020]	Time 0.28 (0.28)	Loss 0.73 (0.73)
		cls_loss 0.45 (0.45)	reg_loss 0.28 (0.28)
[Train]: Epoch 26 finished with lr=0.00001655


[Train]: Epoch 27 started
Epoch: [027][00010/00020]	Time 0.27 (0.27)	Loss 0.13 (0.13)
		cls_loss 0.08 (0.08)	reg_loss 0.05 (0.05)
[Train]: Epoch 27 finished with lr=0.00001285


[Train]: Epoch 28 started
Epoch: [028][00010/00020]	Time 0.28 (0.28)	Loss 0.89 (0.89)
		cls_loss 0.48 (0.48)	reg_loss 0.41 (0.41)
[Train]: Epoch 28 finished with lr=0.00000956


[Train]: Epoch 29 started
Epoch: [029][00010/00020]	Time 0.28 (0.28)	Loss 0.14 (0.14)
		cls_loss 0.08 (0.08)	reg_loss 0.07 (0.07)
[Train]: Epoch 29 finished with lr=0.00000671


[Train]: Epoch 30 started
Epoch: [030][00010/00020]	Time 0.29 (0.29)	Loss 0.57 (0.57)
		cls_loss 0.37 (0.37)	reg_loss 0.21 (0.21)
[Train]: Epoch 30 finished with lr=0.00000433


[Train]: Epoch 31 started
Epoch: [031][00010/00020]	Time 0.27 (0.27)	Loss 0.77 (0.77)
		cls_loss 0.42 (0.42)	reg_loss 0.35 (0.35)
[Train]: Epoch 31 finished with lr=0.00000246


[Train]: Epoch 32 started
Epoch: [032][00010/00020]	Time 0.27 (0.27)	Loss 0.18 (0.18)
		cls_loss 0.10 (0.10)	reg_loss 0.08 (0.08)
[Train]: Epoch 32 finished with lr=0.00000110


[Train]: Epoch 33 started
Epoch: [033][00010/00020]	Time 0.27 (0.27)	Loss 0.20 (0.20)
		cls_loss 0.12 (0.12)	reg_loss 0.08 (0.08)
[Train]: Epoch 33 finished with lr=0.00000028


[Train]: Epoch 34 started
Epoch: [034][00010/00020]	Time 0.27 (0.27)	Loss 0.13 (0.13)
		cls_loss 0.07 (0.07)	reg_loss 0.06 (0.06)
[Train]: Epoch 34 finished with lr=0.00000001

Time taken to train: 186.63073444366455
All done!
/home/jwarchocki/.conda/envs/action-former/lib/python3.10/site-packages/torch/utils/data/dataloader.py:554: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
/home/jwarchocki/.conda/envs/action-former/lib/python3.10/site-packages/torch/utils/data/dataloader.py:554: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
{'dataset': {'crop_ratio': [0.9, 1.0],
             'default_fps': None,
             'downsample_rate': 1,
             'feat_folder': './data/thumos/i3d_features',
             'feat_stride': 4,
             'file_ext': '.npy',
             'file_prefix': None,
             'force_upsampling': False,
             'input_dim': 2048,
             'json_file': './data/thumos/annotations/thumos14.json',
             'max_seq_len': 2304,
             'num_classes': 20,
             'num_frames': 16,
             'trunc_thresh': 0.5},
 'dataset_name': 'thumos',
 'devices': ['cuda:0'],
 'init_rand_seed': 1234567891,
 'loader': {'batch_size': 2, 'num_workers': 4},
 'model': {'backbone_arch': (2, 2, 5),
           'backbone_type': 'convTransformer',
           'embd_dim': 512,
           'embd_kernel_size': 3,
           'embd_with_ln': True,
           'fpn_dim': 512,
           'fpn_start_level': 0,
           'fpn_type': 'identity',
           'fpn_with_ln': True,
           'head_dim': 512,
           'head_kernel_size': 3,
           'head_num_layers': 3,
           'head_with_ln': True,
           'input_dim': 2048,
           'max_buffer_len_factor': 6.0,
           'max_seq_len': 2304,
           'n_head': 4,
           'n_mha_win_size': 19,
           'num_classes': 20,
           'regression_range': [(0, 4),
                                (4, 8),
                                (8, 16),
                                (16, 32),
                                (32, 64),
                                (64, 10000)],
           'scale_factor': 2,
           'test_cfg': {'duration_thresh': 0.05,
                        'ext_score_file': None,
                        'iou_threshold': 0.1,
                        'max_seg_num': 200,
                        'min_score': 0.001,
                        'multiclass_nms': True,
                        'nms_method': 'soft',
                        'nms_sigma': 0.5,
                        'pre_nms_thresh': 0.001,
                        'pre_nms_topk': 2000,
                        'voting_thresh': 0.7},
           'train_cfg': {'center_sample': 'radius',
                         'center_sample_radius': 1.5,
                         'clip_grad_l2norm': 1.0,
                         'cls_prior_prob': 0.01,
                         'dropout': 0.0,
                         'droppath': 0.1,
                         'head_empty_cls': [],
                         'init_loss_norm': 100,
                         'label_smoothing': 0.0,
                         'loss_weight': 1.0},
           'use_abs_pe': False,
           'use_rel_pe': False},
 'model_name': 'LocPointTransformer',
 'opt': {'epochs': 30,
         'learning_rate': 0.0001,
         'momentum': 0.9,
         'schedule_gamma': 0.1,
         'schedule_steps': [],
         'schedule_type': 'cosine',
         'type': 'AdamW',
         'warmup': True,
         'warmup_epochs': 5,
         'weight_decay': 0.05},
 'output_folder': './ckpt/',
 'test_cfg': {'duration_thresh': 0.05,
              'ext_score_file': None,
              'iou_threshold': 0.1,
              'max_seg_num': 200,
              'min_score': 0.001,
              'multiclass_nms': True,
              'nms_method': 'soft',
              'nms_sigma': 0.5,
              'pre_nms_thresh': 0.001,
              'pre_nms_topk': 2000,
              'voting_thresh': 0.7},
 'train_cfg': {'center_sample': 'radius',
               'center_sample_radius': 1.5,
               'clip_grad_l2norm': 1.0,
               'cls_prior_prob': 0.01,
               'dropout': 0.0,
               'droppath': 0.1,
               'head_empty_cls': [],
               'init_loss_norm': 100,
               'label_smoothing': 0.0,
               'loss_weight': 1.0},
 'train_split': ['validation'],
 'val_split': ['test']}
=> loading checkpoint './ckpt/thumos_i3d_reproduce/epoch_035.pth.tar'
Loading from EMA model ...

Start testing model LocPointTransformer ...
Test: [00010/00212]	Time 0.52 (0.52)
Test: [00020/00212]	Time 0.10 (0.31)
Test: [00030/00212]	Time 0.10 (0.24)
Test: [00040/00212]	Time 0.10 (0.20)
Test: [00050/00212]	Time 0.10 (0.18)
Test: [00060/00212]	Time 0.08 (0.17)
Test: [00070/00212]	Time 0.09 (0.15)
Test: [00080/00212]	Time 0.09 (0.15)
Test: [00090/00212]	Time 0.10 (0.14)
Test: [00100/00212]	Time 0.10 (0.14)
Test: [00110/00212]	Time 0.11 (0.13)
Test: [00120/00212]	Time 0.09 (0.13)
Test: [00130/00212]	Time 0.10 (0.13)
Test: [00140/00212]	Time 0.10 (0.13)
Test: [00150/00212]	Time 0.09 (0.12)
Test: [00160/00212]	Time 0.11 (0.12)
Test: [00170/00212]	Time 0.12 (0.12)
Test: [00180/00212]	Time 0.09 (0.12)
Test: [00190/00212]	Time 0.10 (0.12)
Test: [00200/00212]	Time 0.09 (0.12)
Test: [00210/00212]	Time 0.08 (0.12)
[RESULTS] Action detection results on thumos14.

|tIoU = 0.30: mAP = 39.84 (%) Recall@1x = 56.84 (%) Recall@5x = 78.36 (%) 
|tIoU = 0.40: mAP = 32.09 (%) Recall@1x = 47.69 (%) Recall@5x = 69.78 (%) 
|tIoU = 0.50: mAP = 23.94 (%) Recall@1x = 38.78 (%) Recall@5x = 57.49 (%) 
|tIoU = 0.60: mAP = 14.46 (%) Recall@1x = 27.97 (%) Recall@5x = 39.90 (%) 
|tIoU = 0.70: mAP = 6.80 (%) Recall@1x = 18.13 (%) Recall@5x = 24.91 (%) 
Average mAP: 23.43 (%)
All done! Total time: 88.55 sec
Looking for a split for p=0.2
Found split for p=0.2 [40 videos]
Moving sampled images to a separate folder
Finished sampling
/home/jwarchocki/.conda/envs/action-former/lib/python3.10/site-packages/torch/utils/data/dataloader.py:554: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
{'dataset': {'crop_ratio': [0.9, 1.0],
             'default_fps': None,
             'downsample_rate': 1,
             'feat_folder': './data/thumos/i3d_features',
             'feat_stride': 4,
             'file_ext': '.npy',
             'file_prefix': None,
             'force_upsampling': False,
             'input_dim': 2048,
             'json_file': './data/thumos/annotations/thumos14.json',
             'max_seq_len': 2304,
             'num_classes': 20,
             'num_frames': 16,
             'trunc_thresh': 0.5},
 'dataset_name': 'thumos',
 'devices': ['cuda:0'],
 'init_rand_seed': 1234567891,
 'loader': {'batch_size': 2, 'num_workers': 4},
 'model': {'backbone_arch': (2, 2, 5),
           'backbone_type': 'convTransformer',
           'embd_dim': 512,
           'embd_kernel_size': 3,
           'embd_with_ln': True,
           'fpn_dim': 512,
           'fpn_start_level': 0,
           'fpn_type': 'identity',
           'fpn_with_ln': True,
           'head_dim': 512,
           'head_kernel_size': 3,
           'head_num_layers': 3,
           'head_with_ln': True,
           'input_dim': 2048,
           'max_buffer_len_factor': 6.0,
           'max_seq_len': 2304,
           'n_head': 4,
           'n_mha_win_size': 19,
           'num_classes': 20,
           'regression_range': [(0, 4),
                                (4, 8),
                                (8, 16),
                                (16, 32),
                                (32, 64),
                                (64, 10000)],
           'scale_factor': 2,
           'test_cfg': {'duration_thresh': 0.05,
                        'ext_score_file': None,
                        'iou_threshold': 0.1,
                        'max_seg_num': 200,
                        'min_score': 0.001,
                        'multiclass_nms': True,
                        'nms_method': 'soft',
                        'nms_sigma': 0.5,
                        'pre_nms_thresh': 0.001,
                        'pre_nms_topk': 2000,
                        'voting_thresh': 0.7},
           'train_cfg': {'center_sample': 'radius',
                         'center_sample_radius': 1.5,
                         'clip_grad_l2norm': 1.0,
                         'cls_prior_prob': 0.01,
                         'dropout': 0.0,
                         'droppath': 0.1,
                         'head_empty_cls': [],
                         'init_loss_norm': 100,
                         'label_smoothing': 0.0,
                         'loss_weight': 1.0},
           'use_abs_pe': False,
           'use_rel_pe': False},
 'model_name': 'LocPointTransformer',
 'opt': {'epochs': 30,
         'learning_rate': 0.0001,
         'momentum': 0.9,
         'schedule_gamma': 0.1,
         'schedule_steps': [],
         'schedule_type': 'cosine',
         'type': 'AdamW',
         'warmup': True,
         'warmup_epochs': 5,
         'weight_decay': 0.05},
 'output_folder': './ckpt/',
 'test_cfg': {'duration_thresh': 0.05,
              'ext_score_file': None,
              'iou_threshold': 0.1,
              'max_seg_num': 200,
              'min_score': 0.001,
              'multiclass_nms': True,
              'nms_method': 'soft',
              'nms_sigma': 0.5,
              'pre_nms_thresh': 0.001,
              'pre_nms_topk': 2000,
              'voting_thresh': 0.7},
 'train_cfg': {'center_sample': 'radius',
               'center_sample_radius': 1.5,
               'clip_grad_l2norm': 1.0,
               'cls_prior_prob': 0.01,
               'dropout': 0.0,
               'droppath': 0.1,
               'head_empty_cls': [],
               'init_loss_norm': 100,
               'label_smoothing': 0.0,
               'loss_weight': 1.0},
 'train_split': ['validation'],
 'val_split': ['test']}
Using model EMA ...

Start training model LocPointTransformer ...

[Train]: Epoch 0 started
Epoch: [000][00010/00020]	Time 1.39 (1.39)	Loss 0.55 (0.55)
		cls_loss 0.35 (0.35)	reg_loss 0.20 (0.20)
[Train]: Epoch 0 finished with lr=0.00002020


[Train]: Epoch 1 started
Epoch: [001][00010/00020]	Time 0.30 (0.30)	Loss 0.84 (0.84)
		cls_loss 0.61 (0.61)	reg_loss 0.23 (0.23)
[Train]: Epoch 1 finished with lr=0.00004040


[Train]: Epoch 2 started
Epoch: [002][00010/00020]	Time 0.28 (0.28)	Loss 0.26 (0.26)
		cls_loss 0.19 (0.19)	reg_loss 0.07 (0.07)
[Train]: Epoch 2 finished with lr=0.00006061


[Train]: Epoch 3 started
Epoch: [003][00010/00020]	Time 0.29 (0.29)	Loss 0.37 (0.37)
		cls_loss 0.28 (0.28)	reg_loss 0.09 (0.09)
[Train]: Epoch 3 finished with lr=0.00008081


[Train]: Epoch 4 started
Epoch: [004][00010/00020]	Time 0.28 (0.28)	Loss 0.53 (0.53)
		cls_loss 0.40 (0.40)	reg_loss 0.13 (0.13)
[Train]: Epoch 4 finished with lr=0.00010000


[Train]: Epoch 5 started
Epoch: [005][00010/00020]	Time 0.29 (0.29)	Loss 0.98 (0.98)
		cls_loss 0.72 (0.72)	reg_loss 0.26 (0.26)
[Train]: Epoch 5 finished with lr=0.00009973


[Train]: Epoch 6 started
Epoch: [006][00010/00020]	Time 0.28 (0.28)	Loss 0.22 (0.22)
		cls_loss 0.16 (0.16)	reg_loss 0.06 (0.06)
[Train]: Epoch 6 finished with lr=0.00009891


[Train]: Epoch 7 started
Epoch: [007][00010/00020]	Time 0.28 (0.28)	Loss 0.53 (0.53)
		cls_loss 0.35 (0.35)	reg_loss 0.18 (0.18)
[Train]: Epoch 7 finished with lr=0.00009755


[Train]: Epoch 8 started
Epoch: [008][00010/00020]	Time 0.27 (0.27)	Loss 0.26 (0.26)
		cls_loss 0.19 (0.19)	reg_loss 0.07 (0.07)
[Train]: Epoch 8 finished with lr=0.00009568


[Train]: Epoch 9 started
Epoch: [009][00010/00020]	Time 0.27 (0.27)	Loss 0.98 (0.98)
		cls_loss 0.73 (0.73)	reg_loss 0.26 (0.26)
[Train]: Epoch 9 finished with lr=0.00009330


[Train]: Epoch 10 started
Epoch: [010][00010/00020]	Time 0.28 (0.28)	Loss 0.14 (0.14)
		cls_loss 0.08 (0.08)	reg_loss 0.06 (0.06)
[Train]: Epoch 10 finished with lr=0.00009045


[Train]: Epoch 11 started
Epoch: [011][00010/00020]	Time 0.28 (0.28)	Loss 1.12 (1.12)
		cls_loss 0.78 (0.78)	reg_loss 0.34 (0.34)
[Train]: Epoch 11 finished with lr=0.00008716


[Train]: Epoch 12 started
Epoch: [012][00010/00020]	Time 0.30 (0.30)	Loss 0.20 (0.20)
		cls_loss 0.13 (0.13)	reg_loss 0.06 (0.06)
[Train]: Epoch 12 finished with lr=0.00008346


[Train]: Epoch 13 started
Epoch: [013][00010/00020]	Time 0.28 (0.28)	Loss 0.23 (0.23)
		cls_loss 0.15 (0.15)	reg_loss 0.09 (0.09)
[Train]: Epoch 13 finished with lr=0.00007939


[Train]: Epoch 14 started
Epoch: [014][00010/00020]	Time 0.28 (0.28)	Loss 1.21 (1.21)
		cls_loss 0.86 (0.86)	reg_loss 0.35 (0.35)
[Train]: Epoch 14 finished with lr=0.00007500


[Train]: Epoch 15 started
Epoch: [015][00010/00020]	Time 0.31 (0.31)	Loss 0.12 (0.12)
		cls_loss 0.07 (0.07)	reg_loss 0.05 (0.05)
[Train]: Epoch 15 finished with lr=0.00007034


[Train]: Epoch 16 started
Epoch: [016][00010/00020]	Time 0.28 (0.28)	Loss 2.20 (2.20)
		cls_loss 1.13 (1.13)	reg_loss 1.07 (1.07)
[Train]: Epoch 16 finished with lr=0.00006545


[Train]: Epoch 17 started
Epoch: [017][00010/00020]	Time 0.28 (0.28)	Loss 1.76 (1.76)
		cls_loss 0.91 (0.91)	reg_loss 0.84 (0.84)
[Train]: Epoch 17 finished with lr=0.00006040


[Train]: Epoch 18 started
Epoch: [018][00010/00020]	Time 0.28 (0.28)	Loss 0.44 (0.44)
		cls_loss 0.27 (0.27)	reg_loss 0.18 (0.18)
[Train]: Epoch 18 finished with lr=0.00005523


[Train]: Epoch 19 started
Epoch: [019][00010/00020]	Time 0.28 (0.28)	Loss 1.47 (1.47)
		cls_loss 0.72 (0.72)	reg_loss 0.75 (0.75)
[Train]: Epoch 19 finished with lr=0.00005001


[Train]: Epoch 20 started
Epoch: [020][00010/00020]	Time 0.27 (0.27)	Loss 0.29 (0.29)
		cls_loss 0.18 (0.18)	reg_loss 0.11 (0.11)
[Train]: Epoch 20 finished with lr=0.00004478


[Train]: Epoch 21 started
Epoch: [021][00010/00020]	Time 0.28 (0.28)	Loss 0.23 (0.23)
		cls_loss 0.14 (0.14)	reg_loss 0.09 (0.09)
[Train]: Epoch 21 finished with lr=0.00003961


[Train]: Epoch 22 started
Epoch: [022][00010/00020]	Time 0.28 (0.28)	Loss 0.38 (0.38)
		cls_loss 0.24 (0.24)	reg_loss 0.14 (0.14)
[Train]: Epoch 22 finished with lr=0.00003456


[Train]: Epoch 23 started
Epoch: [023][00010/00020]	Time 0.28 (0.28)	Loss 0.25 (0.25)
		cls_loss 0.16 (0.16)	reg_loss 0.09 (0.09)
[Train]: Epoch 23 finished with lr=0.00002967


[Train]: Epoch 24 started
Epoch: [024][00010/00020]	Time 0.28 (0.28)	Loss 0.13 (0.13)
		cls_loss 0.07 (0.07)	reg_loss 0.06 (0.06)
[Train]: Epoch 24 finished with lr=0.00002501


[Train]: Epoch 25 started
Epoch: [025][00010/00020]	Time 0.28 (0.28)	Loss 0.24 (0.24)
		cls_loss 0.14 (0.14)	reg_loss 0.11 (0.11)
[Train]: Epoch 25 finished with lr=0.00002062


[Train]: Epoch 26 started
Epoch: [026][00010/00020]	Time 0.28 (0.28)	Loss 0.29 (0.29)
		cls_loss 0.15 (0.15)	reg_loss 0.15 (0.15)
[Train]: Epoch 26 finished with lr=0.00001655


[Train]: Epoch 27 started
Epoch: [027][00010/00020]	Time 0.28 (0.28)	Loss 0.23 (0.23)
		cls_loss 0.15 (0.15)	reg_loss 0.09 (0.09)
[Train]: Epoch 27 finished with lr=0.00001285


[Train]: Epoch 28 started
Epoch: [028][00010/00020]	Time 0.28 (0.28)	Loss 1.55 (1.55)
		cls_loss 0.74 (0.74)	reg_loss 0.81 (0.81)
[Train]: Epoch 28 finished with lr=0.00000956


[Train]: Epoch 29 started
Epoch: [029][00010/00020]	Time 0.27 (0.27)	Loss 0.06 (0.06)
		cls_loss 0.03 (0.03)	reg_loss 0.03 (0.03)
[Train]: Epoch 29 finished with lr=0.00000671


[Train]: Epoch 30 started
Epoch: [030][00010/00020]	Time 0.28 (0.28)	Loss 0.33 (0.33)
		cls_loss 0.20 (0.20)	reg_loss 0.13 (0.13)
[Train]: Epoch 30 finished with lr=0.00000433


[Train]: Epoch 31 started
Epoch: [031][00010/00020]	Time 0.28 (0.28)	Loss 0.10 (0.10)
		cls_loss 0.05 (0.05)	reg_loss 0.04 (0.04)
[Train]: Epoch 31 finished with lr=0.00000246


[Train]: Epoch 32 started
Epoch: [032][00010/00020]	Time 0.28 (0.28)	Loss 0.24 (0.24)
		cls_loss 0.14 (0.14)	reg_loss 0.09 (0.09)
[Train]: Epoch 32 finished with lr=0.00000110


[Train]: Epoch 33 started
Epoch: [033][00010/00020]	Time 0.28 (0.28)	Loss 0.06 (0.06)
		cls_loss 0.04 (0.04)	reg_loss 0.02 (0.02)
[Train]: Epoch 33 finished with lr=0.00000028


[Train]: Epoch 34 started
Epoch: [034][00010/00020]	Time 0.30 (0.30)	Loss 1.49 (1.49)
		cls_loss 0.70 (0.70)	reg_loss 0.79 (0.79)
[Train]: Epoch 34 finished with lr=0.00000001

Time taken to train: 199.77523517608643
All done!
/home/jwarchocki/.conda/envs/action-former/lib/python3.10/site-packages/torch/utils/data/dataloader.py:554: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
/home/jwarchocki/.conda/envs/action-former/lib/python3.10/site-packages/torch/utils/data/dataloader.py:554: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
{'dataset': {'crop_ratio': [0.9, 1.0],
             'default_fps': None,
             'downsample_rate': 1,
             'feat_folder': './data/thumos/i3d_features',
             'feat_stride': 4,
             'file_ext': '.npy',
             'file_prefix': None,
             'force_upsampling': False,
             'input_dim': 2048,
             'json_file': './data/thumos/annotations/thumos14.json',
             'max_seq_len': 2304,
             'num_classes': 20,
             'num_frames': 16,
             'trunc_thresh': 0.5},
 'dataset_name': 'thumos',
 'devices': ['cuda:0'],
 'init_rand_seed': 1234567891,
 'loader': {'batch_size': 2, 'num_workers': 4},
 'model': {'backbone_arch': (2, 2, 5),
           'backbone_type': 'convTransformer',
           'embd_dim': 512,
           'embd_kernel_size': 3,
           'embd_with_ln': True,
           'fpn_dim': 512,
           'fpn_start_level': 0,
           'fpn_type': 'identity',
           'fpn_with_ln': True,
           'head_dim': 512,
           'head_kernel_size': 3,
           'head_num_layers': 3,
           'head_with_ln': True,
           'input_dim': 2048,
           'max_buffer_len_factor': 6.0,
           'max_seq_len': 2304,
           'n_head': 4,
           'n_mha_win_size': 19,
           'num_classes': 20,
           'regression_range': [(0, 4),
                                (4, 8),
                                (8, 16),
                                (16, 32),
                                (32, 64),
                                (64, 10000)],
           'scale_factor': 2,
           'test_cfg': {'duration_thresh': 0.05,
                        'ext_score_file': None,
                        'iou_threshold': 0.1,
                        'max_seg_num': 200,
                        'min_score': 0.001,
                        'multiclass_nms': True,
                        'nms_method': 'soft',
                        'nms_sigma': 0.5,
                        'pre_nms_thresh': 0.001,
                        'pre_nms_topk': 2000,
                        'voting_thresh': 0.7},
           'train_cfg': {'center_sample': 'radius',
                         'center_sample_radius': 1.5,
                         'clip_grad_l2norm': 1.0,
                         'cls_prior_prob': 0.01,
                         'dropout': 0.0,
                         'droppath': 0.1,
                         'head_empty_cls': [],
                         'init_loss_norm': 100,
                         'label_smoothing': 0.0,
                         'loss_weight': 1.0},
           'use_abs_pe': False,
           'use_rel_pe': False},
 'model_name': 'LocPointTransformer',
 'opt': {'epochs': 30,
         'learning_rate': 0.0001,
         'momentum': 0.9,
         'schedule_gamma': 0.1,
         'schedule_steps': [],
         'schedule_type': 'cosine',
         'type': 'AdamW',
         'warmup': True,
         'warmup_epochs': 5,
         'weight_decay': 0.05},
 'output_folder': './ckpt/',
 'test_cfg': {'duration_thresh': 0.05,
              'ext_score_file': None,
              'iou_threshold': 0.1,
              'max_seg_num': 200,
              'min_score': 0.001,
              'multiclass_nms': True,
              'nms_method': 'soft',
              'nms_sigma': 0.5,
              'pre_nms_thresh': 0.001,
              'pre_nms_topk': 2000,
              'voting_thresh': 0.7},
 'train_cfg': {'center_sample': 'radius',
               'center_sample_radius': 1.5,
               'clip_grad_l2norm': 1.0,
               'cls_prior_prob': 0.01,
               'dropout': 0.0,
               'droppath': 0.1,
               'head_empty_cls': [],
               'init_loss_norm': 100,
               'label_smoothing': 0.0,
               'loss_weight': 1.0},
 'train_split': ['validation'],
 'val_split': ['test']}
=> loading checkpoint './ckpt/thumos_i3d_reproduce/epoch_035.pth.tar'
Loading from EMA model ...

Start testing model LocPointTransformer ...
Test: [00010/00212]	Time 0.53 (0.53)
Test: [00020/00212]	Time 0.10 (0.31)
Test: [00030/00212]	Time 0.10 (0.24)
Test: [00040/00212]	Time 0.11 (0.21)
Test: [00050/00212]	Time 0.10 (0.19)
Test: [00060/00212]	Time 0.08 (0.17)
Test: [00070/00212]	Time 0.09 (0.16)
Test: [00080/00212]	Time 0.09 (0.15)
Test: [00090/00212]	Time 0.10 (0.14)
Test: [00100/00212]	Time 0.11 (0.14)
Test: [00110/00212]	Time 0.11 (0.14)
Test: [00120/00212]	Time 0.10 (0.13)
Test: [00130/00212]	Time 0.10 (0.13)
Test: [00140/00212]	Time 0.10 (0.13)
Test: [00150/00212]	Time 0.09 (0.13)
Test: [00160/00212]	Time 0.13 (0.13)
Test: [00170/00212]	Time 0.13 (0.13)
Test: [00180/00212]	Time 0.10 (0.13)
Test: [00190/00212]	Time 0.11 (0.12)
Test: [00200/00212]	Time 0.09 (0.12)
Test: [00210/00212]	Time 0.08 (0.12)
[RESULTS] Action detection results on thumos14.

|tIoU = 0.30: mAP = 39.68 (%) Recall@1x = 54.25 (%) Recall@5x = 78.06 (%) 
|tIoU = 0.40: mAP = 33.25 (%) Recall@1x = 44.90 (%) Recall@5x = 69.73 (%) 
|tIoU = 0.50: mAP = 26.27 (%) Recall@1x = 37.60 (%) Recall@5x = 58.83 (%) 
|tIoU = 0.60: mAP = 15.72 (%) Recall@1x = 27.06 (%) Recall@5x = 40.79 (%) 
|tIoU = 0.70: mAP = 7.60 (%) Recall@1x = 17.53 (%) Recall@5x = 25.47 (%) 
Average mAP: 24.50 (%)
All done! Total time: 125.86 sec
Looking for a split for p=0.2
Found split for p=0.2 [40 videos]
Moving sampled images to a separate folder
Finished sampling
/home/jwarchocki/.conda/envs/action-former/lib/python3.10/site-packages/torch/utils/data/dataloader.py:554: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
{'dataset': {'crop_ratio': [0.9, 1.0],
             'default_fps': None,
             'downsample_rate': 1,
             'feat_folder': './data/thumos/i3d_features',
             'feat_stride': 4,
             'file_ext': '.npy',
             'file_prefix': None,
             'force_upsampling': False,
             'input_dim': 2048,
             'json_file': './data/thumos/annotations/thumos14.json',
             'max_seq_len': 2304,
             'num_classes': 20,
             'num_frames': 16,
             'trunc_thresh': 0.5},
 'dataset_name': 'thumos',
 'devices': ['cuda:0'],
 'init_rand_seed': 1234567891,
 'loader': {'batch_size': 2, 'num_workers': 4},
 'model': {'backbone_arch': (2, 2, 5),
           'backbone_type': 'convTransformer',
           'embd_dim': 512,
           'embd_kernel_size': 3,
           'embd_with_ln': True,
           'fpn_dim': 512,
           'fpn_start_level': 0,
           'fpn_type': 'identity',
           'fpn_with_ln': True,
           'head_dim': 512,
           'head_kernel_size': 3,
           'head_num_layers': 3,
           'head_with_ln': True,
           'input_dim': 2048,
           'max_buffer_len_factor': 6.0,
           'max_seq_len': 2304,
           'n_head': 4,
           'n_mha_win_size': 19,
           'num_classes': 20,
           'regression_range': [(0, 4),
                                (4, 8),
                                (8, 16),
                                (16, 32),
                                (32, 64),
                                (64, 10000)],
           'scale_factor': 2,
           'test_cfg': {'duration_thresh': 0.05,
                        'ext_score_file': None,
                        'iou_threshold': 0.1,
                        'max_seg_num': 200,
                        'min_score': 0.001,
                        'multiclass_nms': True,
                        'nms_method': 'soft',
                        'nms_sigma': 0.5,
                        'pre_nms_thresh': 0.001,
                        'pre_nms_topk': 2000,
                        'voting_thresh': 0.7},
           'train_cfg': {'center_sample': 'radius',
                         'center_sample_radius': 1.5,
                         'clip_grad_l2norm': 1.0,
                         'cls_prior_prob': 0.01,
                         'dropout': 0.0,
                         'droppath': 0.1,
                         'head_empty_cls': [],
                         'init_loss_norm': 100,
                         'label_smoothing': 0.0,
                         'loss_weight': 1.0},
           'use_abs_pe': False,
           'use_rel_pe': False},
 'model_name': 'LocPointTransformer',
 'opt': {'epochs': 30,
         'learning_rate': 0.0001,
         'momentum': 0.9,
         'schedule_gamma': 0.1,
         'schedule_steps': [],
         'schedule_type': 'cosine',
         'type': 'AdamW',
         'warmup': True,
         'warmup_epochs': 5,
         'weight_decay': 0.05},
 'output_folder': './ckpt/',
 'test_cfg': {'duration_thresh': 0.05,
              'ext_score_file': None,
              'iou_threshold': 0.1,
              'max_seg_num': 200,
              'min_score': 0.001,
              'multiclass_nms': True,
              'nms_method': 'soft',
              'nms_sigma': 0.5,
              'pre_nms_thresh': 0.001,
              'pre_nms_topk': 2000,
              'voting_thresh': 0.7},
 'train_cfg': {'center_sample': 'radius',
               'center_sample_radius': 1.5,
               'clip_grad_l2norm': 1.0,
               'cls_prior_prob': 0.01,
               'dropout': 0.0,
               'droppath': 0.1,
               'head_empty_cls': [],
               'init_loss_norm': 100,
               'label_smoothing': 0.0,
               'loss_weight': 1.0},
 'train_split': ['validation'],
 'val_split': ['test']}
Using model EMA ...

Start training model LocPointTransformer ...

[Train]: Epoch 0 started
Epoch: [000][00010/00020]	Time 0.94 (0.94)	Loss 2.67 (2.67)
		cls_loss 1.72 (1.72)	reg_loss 0.95 (0.95)
[Train]: Epoch 0 finished with lr=0.00002020


[Train]: Epoch 1 started
Epoch: [001][00010/00020]	Time 0.27 (0.27)	Loss 0.72 (0.72)
		cls_loss 0.54 (0.54)	reg_loss 0.19 (0.19)
[Train]: Epoch 1 finished with lr=0.00004040


[Train]: Epoch 2 started
Epoch: [002][00010/00020]	Time 0.26 (0.26)	Loss 0.67 (0.67)
		cls_loss 0.45 (0.45)	reg_loss 0.22 (0.22)
[Train]: Epoch 2 finished with lr=0.00006061


[Train]: Epoch 3 started
Epoch: [003][00010/00020]	Time 0.27 (0.27)	Loss 0.41 (0.41)
		cls_loss 0.29 (0.29)	reg_loss 0.12 (0.12)
[Train]: Epoch 3 finished with lr=0.00008081


[Train]: Epoch 4 started
Epoch: [004][00010/00020]	Time 0.27 (0.27)	Loss 1.00 (1.00)
		cls_loss 0.74 (0.74)	reg_loss 0.26 (0.26)
[Train]: Epoch 4 finished with lr=0.00010000


[Train]: Epoch 5 started
Epoch: [005][00010/00020]	Time 0.27 (0.27)	Loss 1.09 (1.09)
		cls_loss 0.87 (0.87)	reg_loss 0.22 (0.22)
[Train]: Epoch 5 finished with lr=0.00009973


[Train]: Epoch 6 started
Epoch: [006][00010/00020]	Time 0.37 (0.37)	Loss 2.02 (2.02)
		cls_loss 1.50 (1.50)	reg_loss 0.51 (0.51)
[Train]: Epoch 6 finished with lr=0.00009891


[Train]: Epoch 7 started
Epoch: [007][00010/00020]	Time 0.48 (0.48)	Loss 1.78 (1.78)
		cls_loss 0.92 (0.92)	reg_loss 0.86 (0.86)
[Train]: Epoch 7 finished with lr=0.00009755


[Train]: Epoch 8 started
Epoch: [008][00010/00020]	Time 0.33 (0.33)	Loss 0.55 (0.55)
		cls_loss 0.34 (0.34)	reg_loss 0.21 (0.21)
[Train]: Epoch 8 finished with lr=0.00009568


[Train]: Epoch 9 started
Epoch: [009][00010/00020]	Time 0.28 (0.28)	Loss 0.30 (0.30)
		cls_loss 0.20 (0.20)	reg_loss 0.10 (0.10)
[Train]: Epoch 9 finished with lr=0.00009330


[Train]: Epoch 10 started
Epoch: [010][00010/00020]	Time 0.37 (0.37)	Loss 1.30 (1.30)
		cls_loss 0.73 (0.73)	reg_loss 0.57 (0.57)
[Train]: Epoch 10 finished with lr=0.00009045


[Train]: Epoch 11 started
Epoch: [011][00010/00020]	Time 0.27 (0.27)	Loss 1.05 (1.05)
		cls_loss 0.62 (0.62)	reg_loss 0.43 (0.43)
[Train]: Epoch 11 finished with lr=0.00008716


[Train]: Epoch 12 started
Epoch: [012][00010/00020]	Time 0.56 (0.56)	Loss 1.05 (1.05)
		cls_loss 0.64 (0.64)	reg_loss 0.42 (0.42)
[Train]: Epoch 12 finished with lr=0.00008346


[Train]: Epoch 13 started
Epoch: [013][00010/00020]	Time 0.27 (0.27)	Loss 0.38 (0.38)
		cls_loss 0.27 (0.27)	reg_loss 0.11 (0.11)
[Train]: Epoch 13 finished with lr=0.00007939


[Train]: Epoch 14 started
Epoch: [014][00010/00020]	Time 0.29 (0.29)	Loss 0.31 (0.31)
		cls_loss 0.21 (0.21)	reg_loss 0.10 (0.10)
[Train]: Epoch 14 finished with lr=0.00007500


[Train]: Epoch 15 started
Epoch: [015][00010/00020]	Time 0.29 (0.29)	Loss 0.44 (0.44)
		cls_loss 0.27 (0.27)	reg_loss 0.17 (0.17)
[Train]: Epoch 15 finished with lr=0.00007034


[Train]: Epoch 16 started
Epoch: [016][00010/00020]	Time 0.27 (0.27)	Loss 0.16 (0.16)
		cls_loss 0.12 (0.12)	reg_loss 0.04 (0.04)
[Train]: Epoch 16 finished with lr=0.00006545


[Train]: Epoch 17 started
Epoch: [017][00010/00020]	Time 0.28 (0.28)	Loss 0.29 (0.29)
		cls_loss 0.17 (0.17)	reg_loss 0.13 (0.13)
[Train]: Epoch 17 finished with lr=0.00006040


[Train]: Epoch 18 started
Epoch: [018][00010/00020]	Time 0.27 (0.27)	Loss 0.37 (0.37)
		cls_loss 0.24 (0.24)	reg_loss 0.13 (0.13)
[Train]: Epoch 18 finished with lr=0.00005523


[Train]: Epoch 19 started
Epoch: [019][00010/00020]	Time 0.28 (0.28)	Loss 0.28 (0.28)
		cls_loss 0.16 (0.16)	reg_loss 0.12 (0.12)
[Train]: Epoch 19 finished with lr=0.00005001


[Train]: Epoch 20 started
Epoch: [020][00010/00020]	Time 0.27 (0.27)	Loss 0.58 (0.58)
		cls_loss 0.36 (0.36)	reg_loss 0.22 (0.22)
[Train]: Epoch 20 finished with lr=0.00004478


[Train]: Epoch 21 started
Epoch: [021][00010/00020]	Time 0.28 (0.28)	Loss 0.10 (0.10)
		cls_loss 0.06 (0.06)	reg_loss 0.04 (0.04)
[Train]: Epoch 21 finished with lr=0.00003961


[Train]: Epoch 22 started
Epoch: [022][00010/00020]	Time 0.27 (0.27)	Loss 0.75 (0.75)
		cls_loss 0.39 (0.39)	reg_loss 0.37 (0.37)
[Train]: Epoch 22 finished with lr=0.00003456


[Train]: Epoch 23 started
Epoch: [023][00010/00020]	Time 0.28 (0.28)	Loss 0.22 (0.22)
		cls_loss 0.12 (0.12)	reg_loss 0.10 (0.10)
[Train]: Epoch 23 finished with lr=0.00002967


[Train]: Epoch 24 started
Epoch: [024][00010/00020]	Time 0.29 (0.29)	Loss 0.25 (0.25)
		cls_loss 0.13 (0.13)	reg_loss 0.11 (0.11)
[Train]: Epoch 24 finished with lr=0.00002501


[Train]: Epoch 25 started
Epoch: [025][00010/00020]	Time 0.27 (0.27)	Loss 0.59 (0.59)
		cls_loss 0.35 (0.35)	reg_loss 0.25 (0.25)
[Train]: Epoch 25 finished with lr=0.00002062


[Train]: Epoch 26 started
Epoch: [026][00010/00020]	Time 0.27 (0.27)	Loss 0.39 (0.39)
		cls_loss 0.21 (0.21)	reg_loss 0.17 (0.17)
[Train]: Epoch 26 finished with lr=0.00001655


[Train]: Epoch 27 started
Epoch: [027][00010/00020]	Time 0.28 (0.28)	Loss 0.25 (0.25)
		cls_loss 0.14 (0.14)	reg_loss 0.12 (0.12)
[Train]: Epoch 27 finished with lr=0.00001285


[Train]: Epoch 28 started
Epoch: [028][00010/00020]	Time 0.27 (0.27)	Loss 0.42 (0.42)
		cls_loss 0.22 (0.22)	reg_loss 0.20 (0.20)
[Train]: Epoch 28 finished with lr=0.00000956


[Train]: Epoch 29 started
Epoch: [029][00010/00020]	Time 0.28 (0.28)	Loss 0.32 (0.32)
		cls_loss 0.17 (0.17)	reg_loss 0.14 (0.14)
[Train]: Epoch 29 finished with lr=0.00000671


[Train]: Epoch 30 started
Epoch: [030][00010/00020]	Time 0.28 (0.28)	Loss 0.06 (0.06)
		cls_loss 0.04 (0.04)	reg_loss 0.02 (0.02)
[Train]: Epoch 30 finished with lr=0.00000433


[Train]: Epoch 31 started
Epoch: [031][00010/00020]	Time 0.27 (0.27)	Loss 0.65 (0.65)
		cls_loss 0.33 (0.33)	reg_loss 0.32 (0.32)
[Train]: Epoch 31 finished with lr=0.00000246


[Train]: Epoch 32 started
Epoch: [032][00010/00020]	Time 0.29 (0.29)	Loss 1.37 (1.37)
		cls_loss 0.67 (0.67)	reg_loss 0.70 (0.70)
[Train]: Epoch 32 finished with lr=0.00000110


[Train]: Epoch 33 started
Epoch: [033][00010/00020]	Time 0.27 (0.27)	Loss 0.80 (0.80)
		cls_loss 0.45 (0.45)	reg_loss 0.35 (0.35)
[Train]: Epoch 33 finished with lr=0.00000028


[Train]: Epoch 34 started
Epoch: [034][00010/00020]	Time 0.27 (0.27)	Loss 0.18 (0.18)
		cls_loss 0.11 (0.11)	reg_loss 0.07 (0.07)
[Train]: Epoch 34 finished with lr=0.00000001

Time taken to train: 201.890230178833
All done!
/home/jwarchocki/.conda/envs/action-former/lib/python3.10/site-packages/torch/utils/data/dataloader.py:554: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
/home/jwarchocki/.conda/envs/action-former/lib/python3.10/site-packages/torch/utils/data/dataloader.py:554: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
{'dataset': {'crop_ratio': [0.9, 1.0],
             'default_fps': None,
             'downsample_rate': 1,
             'feat_folder': './data/thumos/i3d_features',
             'feat_stride': 4,
             'file_ext': '.npy',
             'file_prefix': None,
             'force_upsampling': False,
             'input_dim': 2048,
             'json_file': './data/thumos/annotations/thumos14.json',
             'max_seq_len': 2304,
             'num_classes': 20,
             'num_frames': 16,
             'trunc_thresh': 0.5},
 'dataset_name': 'thumos',
 'devices': ['cuda:0'],
 'init_rand_seed': 1234567891,
 'loader': {'batch_size': 2, 'num_workers': 4},
 'model': {'backbone_arch': (2, 2, 5),
           'backbone_type': 'convTransformer',
           'embd_dim': 512,
           'embd_kernel_size': 3,
           'embd_with_ln': True,
           'fpn_dim': 512,
           'fpn_start_level': 0,
           'fpn_type': 'identity',
           'fpn_with_ln': True,
           'head_dim': 512,
           'head_kernel_size': 3,
           'head_num_layers': 3,
           'head_with_ln': True,
           'input_dim': 2048,
           'max_buffer_len_factor': 6.0,
           'max_seq_len': 2304,
           'n_head': 4,
           'n_mha_win_size': 19,
           'num_classes': 20,
           'regression_range': [(0, 4),
                                (4, 8),
                                (8, 16),
                                (16, 32),
                                (32, 64),
                                (64, 10000)],
           'scale_factor': 2,
           'test_cfg': {'duration_thresh': 0.05,
                        'ext_score_file': None,
                        'iou_threshold': 0.1,
                        'max_seg_num': 200,
                        'min_score': 0.001,
                        'multiclass_nms': True,
                        'nms_method': 'soft',
                        'nms_sigma': 0.5,
                        'pre_nms_thresh': 0.001,
                        'pre_nms_topk': 2000,
                        'voting_thresh': 0.7},
           'train_cfg': {'center_sample': 'radius',
                         'center_sample_radius': 1.5,
                         'clip_grad_l2norm': 1.0,
                         'cls_prior_prob': 0.01,
                         'dropout': 0.0,
                         'droppath': 0.1,
                         'head_empty_cls': [],
                         'init_loss_norm': 100,
                         'label_smoothing': 0.0,
                         'loss_weight': 1.0},
           'use_abs_pe': False,
           'use_rel_pe': False},
 'model_name': 'LocPointTransformer',
 'opt': {'epochs': 30,
         'learning_rate': 0.0001,
         'momentum': 0.9,
         'schedule_gamma': 0.1,
         'schedule_steps': [],
         'schedule_type': 'cosine',
         'type': 'AdamW',
         'warmup': True,
         'warmup_epochs': 5,
         'weight_decay': 0.05},
 'output_folder': './ckpt/',
 'test_cfg': {'duration_thresh': 0.05,
              'ext_score_file': None,
              'iou_threshold': 0.1,
              'max_seg_num': 200,
              'min_score': 0.001,
              'multiclass_nms': True,
              'nms_method': 'soft',
              'nms_sigma': 0.5,
              'pre_nms_thresh': 0.001,
              'pre_nms_topk': 2000,
              'voting_thresh': 0.7},
 'train_cfg': {'center_sample': 'radius',
               'center_sample_radius': 1.5,
               'clip_grad_l2norm': 1.0,
               'cls_prior_prob': 0.01,
               'dropout': 0.0,
               'droppath': 0.1,
               'head_empty_cls': [],
               'init_loss_norm': 100,
               'label_smoothing': 0.0,
               'loss_weight': 1.0},
 'train_split': ['validation'],
 'val_split': ['test']}
=> loading checkpoint './ckpt/thumos_i3d_reproduce/epoch_035.pth.tar'
Loading from EMA model ...

Start testing model LocPointTransformer ...
Test: [00010/00212]	Time 0.56 (0.56)
Test: [00020/00212]	Time 0.10 (0.33)
Test: [00030/00212]	Time 0.25 (0.30)
Test: [00040/00212]	Time 0.12 (0.25)
Test: [00050/00212]	Time 0.10 (0.22)
Test: [00060/00212]	Time 0.08 (0.20)
Test: [00070/00212]	Time 0.09 (0.19)
Test: [00080/00212]	Time 0.10 (0.18)
Test: [00090/00212]	Time 0.10 (0.17)
Test: [00100/00212]	Time 0.11 (0.16)
Test: [00110/00212]	Time 0.12 (0.16)
Test: [00120/00212]	Time 0.10 (0.15)
Test: [00130/00212]	Time 0.10 (0.15)
Test: [00140/00212]	Time 0.10 (0.14)
Test: [00150/00212]	Time 0.09 (0.14)
Test: [00160/00212]	Time 0.14 (0.14)
Test: [00170/00212]	Time 0.13 (0.14)
Test: [00180/00212]	Time 0.10 (0.14)
Test: [00190/00212]	Time 0.11 (0.14)
Test: [00200/00212]	Time 0.09 (0.13)
Test: [00210/00212]	Time 0.08 (0.13)
[RESULTS] Action detection results on thumos14.

|tIoU = 0.30: mAP = 41.05 (%) Recall@1x = 57.72 (%) Recall@5x = 81.34 (%) 
|tIoU = 0.40: mAP = 32.52 (%) Recall@1x = 48.10 (%) Recall@5x = 71.29 (%) 
|tIoU = 0.50: mAP = 24.36 (%) Recall@1x = 39.71 (%) Recall@5x = 60.74 (%) 
|tIoU = 0.60: mAP = 14.67 (%) Recall@1x = 29.07 (%) Recall@5x = 43.74 (%) 
|tIoU = 0.70: mAP = 7.32 (%) Recall@1x = 19.29 (%) Recall@5x = 27.41 (%) 
Average mAP: 23.98 (%)
All done! Total time: 112.35 sec
Looking for a split for p=0.2
Found split for p=0.2 [40 videos]
Moving sampled images to a separate folder
Finished sampling
/home/jwarchocki/.conda/envs/action-former/lib/python3.10/site-packages/torch/utils/data/dataloader.py:554: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
{'dataset': {'crop_ratio': [0.9, 1.0],
             'default_fps': None,
             'downsample_rate': 1,
             'feat_folder': './data/thumos/i3d_features',
             'feat_stride': 4,
             'file_ext': '.npy',
             'file_prefix': None,
             'force_upsampling': False,
             'input_dim': 2048,
             'json_file': './data/thumos/annotations/thumos14.json',
             'max_seq_len': 2304,
             'num_classes': 20,
             'num_frames': 16,
             'trunc_thresh': 0.5},
 'dataset_name': 'thumos',
 'devices': ['cuda:0'],
 'init_rand_seed': 1234567891,
 'loader': {'batch_size': 2, 'num_workers': 4},
 'model': {'backbone_arch': (2, 2, 5),
           'backbone_type': 'convTransformer',
           'embd_dim': 512,
           'embd_kernel_size': 3,
           'embd_with_ln': True,
           'fpn_dim': 512,
           'fpn_start_level': 0,
           'fpn_type': 'identity',
           'fpn_with_ln': True,
           'head_dim': 512,
           'head_kernel_size': 3,
           'head_num_layers': 3,
           'head_with_ln': True,
           'input_dim': 2048,
           'max_buffer_len_factor': 6.0,
           'max_seq_len': 2304,
           'n_head': 4,
           'n_mha_win_size': 19,
           'num_classes': 20,
           'regression_range': [(0, 4),
                                (4, 8),
                                (8, 16),
                                (16, 32),
                                (32, 64),
                                (64, 10000)],
           'scale_factor': 2,
           'test_cfg': {'duration_thresh': 0.05,
                        'ext_score_file': None,
                        'iou_threshold': 0.1,
                        'max_seg_num': 200,
                        'min_score': 0.001,
                        'multiclass_nms': True,
                        'nms_method': 'soft',
                        'nms_sigma': 0.5,
                        'pre_nms_thresh': 0.001,
                        'pre_nms_topk': 2000,
                        'voting_thresh': 0.7},
           'train_cfg': {'center_sample': 'radius',
                         'center_sample_radius': 1.5,
                         'clip_grad_l2norm': 1.0,
                         'cls_prior_prob': 0.01,
                         'dropout': 0.0,
                         'droppath': 0.1,
                         'head_empty_cls': [],
                         'init_loss_norm': 100,
                         'label_smoothing': 0.0,
                         'loss_weight': 1.0},
           'use_abs_pe': False,
           'use_rel_pe': False},
 'model_name': 'LocPointTransformer',
 'opt': {'epochs': 30,
         'learning_rate': 0.0001,
         'momentum': 0.9,
         'schedule_gamma': 0.1,
         'schedule_steps': [],
         'schedule_type': 'cosine',
         'type': 'AdamW',
         'warmup': True,
         'warmup_epochs': 5,
         'weight_decay': 0.05},
 'output_folder': './ckpt/',
 'test_cfg': {'duration_thresh': 0.05,
              'ext_score_file': None,
              'iou_threshold': 0.1,
              'max_seg_num': 200,
              'min_score': 0.001,
              'multiclass_nms': True,
              'nms_method': 'soft',
              'nms_sigma': 0.5,
              'pre_nms_thresh': 0.001,
              'pre_nms_topk': 2000,
              'voting_thresh': 0.7},
 'train_cfg': {'center_sample': 'radius',
               'center_sample_radius': 1.5,
               'clip_grad_l2norm': 1.0,
               'cls_prior_prob': 0.01,
               'dropout': 0.0,
               'droppath': 0.1,
               'head_empty_cls': [],
               'init_loss_norm': 100,
               'label_smoothing': 0.0,
               'loss_weight': 1.0},
 'train_split': ['validation'],
 'val_split': ['test']}
Using model EMA ...

Start training model LocPointTransformer ...

[Train]: Epoch 0 started
Epoch: [000][00010/00020]	Time 0.94 (0.94)	Loss 1.42 (1.42)
		cls_loss 0.89 (0.89)	reg_loss 0.53 (0.53)
[Train]: Epoch 0 finished with lr=0.00002020


[Train]: Epoch 1 started
Epoch: [001][00010/00020]	Time 0.27 (0.27)	Loss 2.08 (2.08)
		cls_loss 1.47 (1.47)	reg_loss 0.62 (0.62)
[Train]: Epoch 1 finished with lr=0.00004040


[Train]: Epoch 2 started
Epoch: [002][00010/00020]	Time 0.27 (0.27)	Loss 2.26 (2.26)
		cls_loss 1.69 (1.69)	reg_loss 0.57 (0.57)
[Train]: Epoch 2 finished with lr=0.00006061


[Train]: Epoch 3 started
Epoch: [003][00010/00020]	Time 0.29 (0.29)	Loss 1.63 (1.63)
		cls_loss 1.19 (1.19)	reg_loss 0.44 (0.44)
[Train]: Epoch 3 finished with lr=0.00008081


[Train]: Epoch 4 started
Epoch: [004][00010/00020]	Time 0.28 (0.28)	Loss 0.54 (0.54)
		cls_loss 0.36 (0.36)	reg_loss 0.18 (0.18)
[Train]: Epoch 4 finished with lr=0.00010000


[Train]: Epoch 5 started
Epoch: [005][00010/00020]	Time 0.27 (0.27)	Loss 3.04 (3.04)
		cls_loss 1.94 (1.94)	reg_loss 1.10 (1.10)
[Train]: Epoch 5 finished with lr=0.00009973


[Train]: Epoch 6 started
Epoch: [006][00010/00020]	Time 0.28 (0.28)	Loss 0.70 (0.70)
		cls_loss 0.52 (0.52)	reg_loss 0.18 (0.18)
[Train]: Epoch 6 finished with lr=0.00009891


[Train]: Epoch 7 started
Epoch: [007][00010/00020]	Time 0.27 (0.27)	Loss 0.54 (0.54)
		cls_loss 0.43 (0.43)	reg_loss 0.11 (0.11)
[Train]: Epoch 7 finished with lr=0.00009755


[Train]: Epoch 8 started
Epoch: [008][00010/00020]	Time 0.29 (0.29)	Loss 0.61 (0.61)
		cls_loss 0.33 (0.33)	reg_loss 0.28 (0.28)
[Train]: Epoch 8 finished with lr=0.00009568


[Train]: Epoch 9 started
Epoch: [009][00010/00020]	Time 0.28 (0.28)	Loss 0.35 (0.35)
		cls_loss 0.27 (0.27)	reg_loss 0.09 (0.09)
[Train]: Epoch 9 finished with lr=0.00009330


[Train]: Epoch 10 started
Epoch: [010][00010/00020]	Time 0.27 (0.27)	Loss 1.07 (1.07)
		cls_loss 0.78 (0.78)	reg_loss 0.29 (0.29)
[Train]: Epoch 10 finished with lr=0.00009045


[Train]: Epoch 11 started
Epoch: [011][00010/00020]	Time 0.28 (0.28)	Loss 0.21 (0.21)
		cls_loss 0.14 (0.14)	reg_loss 0.07 (0.07)
[Train]: Epoch 11 finished with lr=0.00008716


[Train]: Epoch 12 started
Epoch: [012][00010/00020]	Time 0.27 (0.27)	Loss 0.53 (0.53)
		cls_loss 0.32 (0.32)	reg_loss 0.21 (0.21)
[Train]: Epoch 12 finished with lr=0.00008346


[Train]: Epoch 13 started
Epoch: [013][00010/00020]	Time 0.29 (0.29)	Loss 0.64 (0.64)
		cls_loss 0.40 (0.40)	reg_loss 0.23 (0.23)
[Train]: Epoch 13 finished with lr=0.00007939


[Train]: Epoch 14 started
Epoch: [014][00010/00020]	Time 0.29 (0.29)	Loss 1.81 (1.81)
		cls_loss 0.88 (0.88)	reg_loss 0.93 (0.93)
[Train]: Epoch 14 finished with lr=0.00007500


[Train]: Epoch 15 started
Epoch: [015][00010/00020]	Time 0.30 (0.30)	Loss 0.62 (0.62)
		cls_loss 0.33 (0.33)	reg_loss 0.30 (0.30)
[Train]: Epoch 15 finished with lr=0.00007034


[Train]: Epoch 16 started
Epoch: [016][00010/00020]	Time 0.29 (0.29)	Loss 0.13 (0.13)
		cls_loss 0.08 (0.08)	reg_loss 0.05 (0.05)
[Train]: Epoch 16 finished with lr=0.00006545


[Train]: Epoch 17 started
Epoch: [017][00010/00020]	Time 0.28 (0.28)	Loss 0.40 (0.40)
		cls_loss 0.25 (0.25)	reg_loss 0.15 (0.15)
[Train]: Epoch 17 finished with lr=0.00006040


[Train]: Epoch 18 started
Epoch: [018][00010/00020]	Time 0.29 (0.29)	Loss 0.36 (0.36)
		cls_loss 0.20 (0.20)	reg_loss 0.16 (0.16)
[Train]: Epoch 18 finished with lr=0.00005523


[Train]: Epoch 19 started
Epoch: [019][00010/00020]	Time 0.28 (0.28)	Loss 0.25 (0.25)
		cls_loss 0.14 (0.14)	reg_loss 0.11 (0.11)
[Train]: Epoch 19 finished with lr=0.00005001


[Train]: Epoch 20 started
Epoch: [020][00010/00020]	Time 0.28 (0.28)	Loss 0.68 (0.68)
		cls_loss 0.34 (0.34)	reg_loss 0.34 (0.34)
[Train]: Epoch 20 finished with lr=0.00004478


[Train]: Epoch 21 started
Epoch: [021][00010/00020]	Time 0.28 (0.28)	Loss 0.16 (0.16)
		cls_loss 0.08 (0.08)	reg_loss 0.09 (0.09)
[Train]: Epoch 21 finished with lr=0.00003961


[Train]: Epoch 22 started
Epoch: [022][00010/00020]	Time 0.28 (0.28)	Loss 1.23 (1.23)
		cls_loss 0.55 (0.55)	reg_loss 0.68 (0.68)
[Train]: Epoch 22 finished with lr=0.00003456


[Train]: Epoch 23 started
Epoch: [023][00010/00020]	Time 0.28 (0.28)	Loss 0.64 (0.64)
		cls_loss 0.36 (0.36)	reg_loss 0.28 (0.28)
[Train]: Epoch 23 finished with lr=0.00002967


[Train]: Epoch 24 started
Epoch: [024][00010/00020]	Time 0.29 (0.29)	Loss 0.65 (0.65)
		cls_loss 0.40 (0.40)	reg_loss 0.25 (0.25)
[Train]: Epoch 24 finished with lr=0.00002501


[Train]: Epoch 25 started
Epoch: [025][00010/00020]	Time 0.28 (0.28)	Loss 1.34 (1.34)
		cls_loss 0.63 (0.63)	reg_loss 0.71 (0.71)
[Train]: Epoch 25 finished with lr=0.00002062


[Train]: Epoch 26 started
Epoch: [026][00010/00020]	Time 0.27 (0.27)	Loss 0.27 (0.27)
		cls_loss 0.14 (0.14)	reg_loss 0.13 (0.13)
[Train]: Epoch 26 finished with lr=0.00001655


[Train]: Epoch 27 started
Epoch: [027][00010/00020]	Time 0.28 (0.28)	Loss 0.83 (0.83)
		cls_loss 0.45 (0.45)	reg_loss 0.38 (0.38)
[Train]: Epoch 27 finished with lr=0.00001285


[Train]: Epoch 28 started
Epoch: [028][00010/00020]	Time 0.28 (0.28)	Loss 0.29 (0.29)
		cls_loss 0.16 (0.16)	reg_loss 0.13 (0.13)
[Train]: Epoch 28 finished with lr=0.00000956


[Train]: Epoch 29 started
Epoch: [029][00010/00020]	Time 0.28 (0.28)	Loss 0.19 (0.19)
		cls_loss 0.10 (0.10)	reg_loss 0.09 (0.09)
[Train]: Epoch 29 finished with lr=0.00000671


[Train]: Epoch 30 started
Epoch: [030][00010/00020]	Time 0.28 (0.28)	Loss 0.14 (0.14)
		cls_loss 0.08 (0.08)	reg_loss 0.06 (0.06)
[Train]: Epoch 30 finished with lr=0.00000433


[Train]: Epoch 31 started
Epoch: [031][00010/00020]	Time 0.28 (0.28)	Loss 0.48 (0.48)
		cls_loss 0.27 (0.27)	reg_loss 0.22 (0.22)
[Train]: Epoch 31 finished with lr=0.00000246


[Train]: Epoch 32 started
Epoch: [032][00010/00020]	Time 0.27 (0.27)	Loss 0.13 (0.13)
		cls_loss 0.07 (0.07)	reg_loss 0.06 (0.06)
[Train]: Epoch 32 finished with lr=0.00000110


[Train]: Epoch 33 started
Epoch: [033][00010/00020]	Time 0.28 (0.28)	Loss 0.18 (0.18)
		cls_loss 0.11 (0.11)	reg_loss 0.07 (0.07)
[Train]: Epoch 33 finished with lr=0.00000028


[Train]: Epoch 34 started
Epoch: [034][00010/00020]	Time 0.28 (0.28)	Loss 0.08 (0.08)
		cls_loss 0.05 (0.05)	reg_loss 0.03 (0.03)
[Train]: Epoch 34 finished with lr=0.00000001

Time taken to train: 184.3007116317749
All done!
/home/jwarchocki/.conda/envs/action-former/lib/python3.10/site-packages/torch/utils/data/dataloader.py:554: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
/home/jwarchocki/.conda/envs/action-former/lib/python3.10/site-packages/torch/utils/data/dataloader.py:554: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
{'dataset': {'crop_ratio': [0.9, 1.0],
             'default_fps': None,
             'downsample_rate': 1,
             'feat_folder': './data/thumos/i3d_features',
             'feat_stride': 4,
             'file_ext': '.npy',
             'file_prefix': None,
             'force_upsampling': False,
             'input_dim': 2048,
             'json_file': './data/thumos/annotations/thumos14.json',
             'max_seq_len': 2304,
             'num_classes': 20,
             'num_frames': 16,
             'trunc_thresh': 0.5},
 'dataset_name': 'thumos',
 'devices': ['cuda:0'],
 'init_rand_seed': 1234567891,
 'loader': {'batch_size': 2, 'num_workers': 4},
 'model': {'backbone_arch': (2, 2, 5),
           'backbone_type': 'convTransformer',
           'embd_dim': 512,
           'embd_kernel_size': 3,
           'embd_with_ln': True,
           'fpn_dim': 512,
           'fpn_start_level': 0,
           'fpn_type': 'identity',
           'fpn_with_ln': True,
           'head_dim': 512,
           'head_kernel_size': 3,
           'head_num_layers': 3,
           'head_with_ln': True,
           'input_dim': 2048,
           'max_buffer_len_factor': 6.0,
           'max_seq_len': 2304,
           'n_head': 4,
           'n_mha_win_size': 19,
           'num_classes': 20,
           'regression_range': [(0, 4),
                                (4, 8),
                                (8, 16),
                                (16, 32),
                                (32, 64),
                                (64, 10000)],
           'scale_factor': 2,
           'test_cfg': {'duration_thresh': 0.05,
                        'ext_score_file': None,
                        'iou_threshold': 0.1,
                        'max_seg_num': 200,
                        'min_score': 0.001,
                        'multiclass_nms': True,
                        'nms_method': 'soft',
                        'nms_sigma': 0.5,
                        'pre_nms_thresh': 0.001,
                        'pre_nms_topk': 2000,
                        'voting_thresh': 0.7},
           'train_cfg': {'center_sample': 'radius',
                         'center_sample_radius': 1.5,
                         'clip_grad_l2norm': 1.0,
                         'cls_prior_prob': 0.01,
                         'dropout': 0.0,
                         'droppath': 0.1,
                         'head_empty_cls': [],
                         'init_loss_norm': 100,
                         'label_smoothing': 0.0,
                         'loss_weight': 1.0},
           'use_abs_pe': False,
           'use_rel_pe': False},
 'model_name': 'LocPointTransformer',
 'opt': {'epochs': 30,
         'learning_rate': 0.0001,
         'momentum': 0.9,
         'schedule_gamma': 0.1,
         'schedule_steps': [],
         'schedule_type': 'cosine',
         'type': 'AdamW',
         'warmup': True,
         'warmup_epochs': 5,
         'weight_decay': 0.05},
 'output_folder': './ckpt/',
 'test_cfg': {'duration_thresh': 0.05,
              'ext_score_file': None,
              'iou_threshold': 0.1,
              'max_seg_num': 200,
              'min_score': 0.001,
              'multiclass_nms': True,
              'nms_method': 'soft',
              'nms_sigma': 0.5,
              'pre_nms_thresh': 0.001,
              'pre_nms_topk': 2000,
              'voting_thresh': 0.7},
 'train_cfg': {'center_sample': 'radius',
               'center_sample_radius': 1.5,
               'clip_grad_l2norm': 1.0,
               'cls_prior_prob': 0.01,
               'dropout': 0.0,
               'droppath': 0.1,
               'head_empty_cls': [],
               'init_loss_norm': 100,
               'label_smoothing': 0.0,
               'loss_weight': 1.0},
 'train_split': ['validation'],
 'val_split': ['test']}
=> loading checkpoint './ckpt/thumos_i3d_reproduce/epoch_035.pth.tar'
Loading from EMA model ...

Start testing model LocPointTransformer ...
Test: [00010/00212]	Time 0.55 (0.55)
Test: [00020/00212]	Time 0.09 (0.32)
Test: [00030/00212]	Time 0.10 (0.24)
Test: [00040/00212]	Time 0.10 (0.21)
Test: [00050/00212]	Time 0.10 (0.19)
Test: [00060/00212]	Time 0.08 (0.17)
Test: [00070/00212]	Time 0.09 (0.16)
Test: [00080/00212]	Time 0.09 (0.15)
Test: [00090/00212]	Time 0.09 (0.14)
Test: [00100/00212]	Time 0.10 (0.14)
Test: [00110/00212]	Time 0.11 (0.14)
Test: [00120/00212]	Time 0.09 (0.13)
Test: [00130/00212]	Time 0.10 (0.13)
Test: [00140/00212]	Time 0.08 (0.13)
Test: [00150/00212]	Time 0.16 (0.13)
Test: [00160/00212]	Time 0.13 (0.13)
Test: [00170/00212]	Time 0.13 (0.13)
Test: [00180/00212]	Time 0.09 (0.13)
Test: [00190/00212]	Time 0.11 (0.13)
Test: [00200/00212]	Time 0.09 (0.12)
Test: [00210/00212]	Time 0.08 (0.12)
[RESULTS] Action detection results on thumos14.

|tIoU = 0.30: mAP = 37.51 (%) Recall@1x = 52.77 (%) Recall@5x = 72.98 (%) 
|tIoU = 0.40: mAP = 30.04 (%) Recall@1x = 43.77 (%) Recall@5x = 64.85 (%) 
|tIoU = 0.50: mAP = 22.09 (%) Recall@1x = 35.38 (%) Recall@5x = 53.41 (%) 
|tIoU = 0.60: mAP = 12.23 (%) Recall@1x = 25.13 (%) Recall@5x = 38.07 (%) 
|tIoU = 0.70: mAP = 4.86 (%) Recall@1x = 15.19 (%) Recall@5x = 22.49 (%) 
Average mAP: 21.35 (%)
All done! Total time: 114.41 sec
